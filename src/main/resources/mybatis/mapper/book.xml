<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.mbcit.vivere.dao.BookDAO">

<!-- 이미 예약된 좌석의 모든 정보를 불러오는 쿼리 -->
<select id="selectBookedSeats" parameterType="int" resultType="concertSeatVO">
	select * from concertSeat where concertTimeId = #{conTimeId} and bookYN;
</select>


<select id="pastBook"  parameterType="bookVO" resultType="bookVO">
	SELECT a.id
		, a.consumerId
		, a.concertId
		, a.paymentId
		, a.bookNum
		, a.price
		, a.seatCnt
		, a.seatNum
		, a.grade
		, a.orderDate
		, a.concertTime
		, b.title
		, b.hallType
		, b.categoryId 
		, b.posterUrl
	FROM book a LEFT JOIN concert b ON a.concertId  = b.id
	where a.consumerId  = 1
	and concertTime <![CDATA[<=]]> now()
</select>

<select id="getConcertSeatByConTimeId" parameterType="int" resultType="concertSeatVO">
	select * from concertSeat where concertTimeId = #{conTimeId}
</select>

</mapper>





